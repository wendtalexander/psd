---
title: Dendritic p-unit
---

## FFT
Where were we get a very small value on the 0 frequency.

```{python}
# | output: false

import pathlib

import nixio
import numpy as np
import plotly.graph_objects as go
from plotly.subplots import make_subplots
from plots import comparision, spectral

method = "fft"
contrast = 0.1
datafolder = pathlib.Path("../psd/data/punit/vdend/2010-11-08-al-invivo-1/")
dataset_methods = sorted(datafolder.rglob(f"{method}*.nix"))

fig = spectral(dataset_methods, contrast=contrast, negative_frequencies=True)
```

```{python}
# | echo: false
# | renderings: [light, dark]
fig.update_layout(
    height=600,
    width=600,
)
fig.update_layout(template="plotly_white")
display(fig)

fig.update_layout(template="plotly_dark")
display(fig)
```


```{python}
nix_file = nixio.File.open(str(dataset_methods[0]), "r")
block = nix_file.blocks[0]
das = block.data_arrays
contrast_suffix = f"_contrast_{contrast}" if contrast else ""
frequency = das[f"frequency{contrast_suffix}"][:]
coherence = das[f"coherence{contrast_suffix}"][:]
print(f"{coherence[(frequency >= 0) & (frequency < 5)]}")
```

## Welch method

```{python}
# | output: false
method = "welch_segments"
contrast = 0.1
datafolder = pathlib.Path("../psd/data/punit/vdend/2010-11-08-al-invivo-1/")
dataset_methods = sorted(datafolder.rglob(f"{method}*.nix"))

fig = spectral(dataset_methods, contrast=contrast, negative_frequencies=True)
```
```{python}
# | echo: false
# | renderings: [light, dark]
fig.update_layout(
    height=600,
    width=600,
)
fig.update_layout(template="plotly_white")
display(fig)

fig.update_layout(template="plotly_dark")
display(fig)
```
