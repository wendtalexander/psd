---
title: Welch
---


```{python}
# | output : false
import pathlib

import plotly.graph_objects as go
from plotly.subplots import make_subplots
from plots import comparision, get_coherence, spectral

method = "welch"

contrast = 0.1
datafolder = pathlib.Path("../psd/data/punit/duration/2010-11-08-al-invivo-1/")
dataset_methods = sorted(datafolder.rglob(f"{method}*.nix"))
lower = -50
upper = 350

f, coherence = get_coherence(
    dataset_methods, contrast=contrast, lower=lower, upper=upper
)
fig = go.Figure()
fig.add_scattergl(x=f, y=coherence)
x_range = [-350, 350]
fig.update_xaxes(range=x_range)
```

```{python}
# | echo: false
# | renderings: [light, dark]
fig.update_layout(
    height=600,
    width=600,
)
fig.update_layout(template="plotly_white")
display(fig)
fig.update_layout(template="plotly_dark")
display(fig)

```
```{python}
# | output : false
fig = spectral(dataset_methods, contrast=contrast)
```
```{python}
# | echo: false
# | renderings: [light, dark]
fig.update_layout(
    height=600,
    width=600,
)
fig.update_layout(template="plotly_white")
display(fig)
fig.update_layout(template="plotly_dark")
display(fig)

```
## Welch duration compared to without windowing

```{python}
# | echo: false
# | output : false
datafolder_normal = pathlib.Path(
    "../psd/data/punit/jax/2010-11-08-al-invivo-1/fft_2010-11-08-al-invivo-1.nix"
)
datafolder_welch = pathlib.Path(
    "../psd/data/punit/duration/2010-11-08-al-invivo-1/welch_2010-11-08-al-invivo-1.nix"
)
f, coherence = get_coherence(
    [datafolder_normal], contrast=contrast, lower=lower, upper=upper
)

f_w, coherence_w = get_coherence(
    [datafolder_welch], contrast=contrast, lower=lower, upper=upper
)
fig = go.Figure()
fig.add_scattergl(x=f, y=coherence, name="without winodow")
fig.add_scattergl(x=f_w, y=coherence_w, name="welch")
x_range = [-350, 350]
fig.update_xaxes(range=x_range)
```

```{python}
# | echo: false
# | renderings: [light, dark]
fig.update_layout(
    height=600,
    width=600,
)
fig.update_layout(template="plotly_white")
display(fig)
fig.update_layout(template="plotly_dark")
display(fig)
```
