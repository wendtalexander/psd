---
title: P-Unit without adaptation
---

```{python}
# | output: false

import pathlib

import nixio
import plotly.graph_objects as go
from plotly.subplots import make_subplots
from plots import comparision, rate, rate_comparision, spectral

method = "fft"
contrast = 0.1
cell_id = 0
datafolder = pathlib.Path("../psd/data/punit/without_adaptation/")
dataset_methods = sorted(datafolder.rglob(f"{method}*.nix"))

datafolder = pathlib.Path("../psd/data/punit/jax/")
dataset_methods_org = sorted(datafolder.rglob(f"{method}*.nix"))

fig = spectral(dataset_methods, contrast=contrast, negative_frequencies=True)
```

```{python}
# | echo: false
# | renderings: [light, dark]
fig.update_layout(
    height=600,
    width=600,
)
fig.update_layout(template="plotly_white")
display(fig)

fig.update_layout(template="plotly_dark")
display(fig)
```

## 1.Rate

```{python}
# | output: false
fig = rate_comparision(
    [dataset_methods[0], dataset_methods_org[0]],
    names=["adap", "org"],
    contrast=contrast,
)
```


```{python}
# | echo: false
# | renderings: [light, dark]
fig.update_layout(
    height=600,
    width=600,
)
fig.update_layout(template="plotly_white")
display(fig)

fig.update_layout(template="plotly_dark")
display(fig)
```

## 2. Comparision to original

```{python}
# | output: false
fig = comparision(
    dataset_methods,
    dataset_methods_org,
    contrast=contrast,
    negative_frequencies=True,
    names=["adaptation", "org"],
)
```

```{python}
# | echo: false
# | renderings: [light, dark]
fig.update_layout(
    height=600,
    width=600,
)
fig.update_layout(template="plotly_white")
display(fig)

fig.update_layout(template="plotly_dark")
display(fig)
```

```{python}
# | output: false
fig = rate(dataset_methods, contrast=contrast)
```
